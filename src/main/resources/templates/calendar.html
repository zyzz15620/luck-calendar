<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Luck Calendar</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}">
    <script>
        function updateDays() {
            const days = document.getElementById('days').value;
            const offset = document.getElementById('offset').value;
            if (days) {
                window.location.href = `/calendar?days=${days}&offset=${offset}`;
            }
        }
    </script>
</head>
<body>
<!-- Tooltip -->
<div class="tooltip">
    <span class="tooltiptext" th:utext="${tooltipText}"></span>
</div>

<!-- Tiêu đề -->
<header class="header">
    <h1 class="centered">Luck Calendar</h1>
    <h2 class="centered">Tháng: <span th:text="${calendar[0].month}"></span>/<span th:text="${calendar[0].year}"></span></h2>
</header>

<!-- Điều hướng -->
<div class="navigation centered">
    <a class="nav-arrow" th:href="@{/calendar(days=${days}, offset=${offset - 1})}">&larr;</a>
    <span th:text="${startDate} + ' - ' + ${endDate}"></span>
    <a class="nav-arrow" th:href="@{/calendar(days=${days}, offset=${offset + 1})}">&rarr;</a>
</div>

<!-- Hien thi so ngay -->
<div class="centered">
    <label for="days">Chế độ xem:</label>
    <select name="days" id="days" onchange="updateDays()">
        <option value="" disabled selected>Chọn số ngày</option>
        <option value="4" th:selected="${days == 4}">4 ngày</option>
        <option value="7" th:selected="${days == 7}">7 ngày</option>
    </select>
    <input type="hidden" id="offset" th:value="${offset}">
</div>

<!-- Bảng lịch -->
<div class="table-container">
    <table class="calendar-table">
        <!-- Header -->
        <thead>
        <tr>
            <th>Giờ</th>
            <th th:each="dayLuck, iter : ${calendar}">
                <span th:text="${dayLuck.dayOfWeek}"></span><br>
                <span th:text="${dayLuck.day + '/' + dayLuck.month}"></span><br>
                <span>Âm lịch:</span> <span th:text="${lunarDates[iter.index]}"></span>/<span th:text="${calendar[0].year}"></span>
            </th>
        </tr>
        </thead>
        <!-- Body -->
        <tbody>
        <tr th:each="timeIndex : ${#numbers.sequence(0, 11)}">
            <td th:text="${calendar[0].timeLuckList[timeIndex].formattedTime}"></td>
            <td th:each="dayLuck : ${calendar}" th:style="'background-color: ' + ${dayLuck.timeLuckList[timeIndex].color}">
                <div class="day-box">
                    <span th:utext="${dayLuck.timeLuckList[timeIndex].detailedInfo}"></span>
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</div>
</body>
</html>