<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Luck Calendar</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link th:href="@{/css/style.css}" rel="stylesheet"/>
    <link rel="icon" type="image/x-icon" th:href="@{/xemNgayFavicon.ico}"/>
    <script>
        function updateDays() {
            const days = document.getElementById('days').value;
            const offset = document.getElementById('offset').value;
            if (days) {
                window.location.href = `/calendar?days=${days}&offset=${offset}`;
            }
        }
    </script>
</head>
<body>
<div th:replace="~{fragments/navigation :: navigation}"></div>


<!-- Tiêu đề -->
<header class="header">
    <img th:src="@{/xemngayLogo.png}" alt="Logo" class="logo">
    <h1 class="centered">Luck Calendar</h1>
    <h2 class="centered">Tháng: <span th:text="${calendar[0].month}"></span>/<span th:text="${calendar[0].year}"></span></h2>
</header>
<!-- Điều hướng -->
<div class="navigation centered">
    <a class="nav-arrow" th:href="@{/calendar(days=${days}, offset=${offset - 1})}">&larr;</a>
    <span th:text="${startDate} + ' - ' + ${endDate}"></span>
    <a class="nav-arrow" th:href="@{/calendar(days=${days}, offset=${offset + 1})}">&rarr;</a>
</div>

<!-- Hien thi so ngay -->
<div class="centered">
    <label for="days">Chế độ xem:</label>
    <select name="days" id="days" onchange="updateDays()">
        <option value="" disabled selected>Chọn số ngày</option>
        <option value="4" th:selected="${days == 4}">4 ngày</option>
        <option value="7" th:selected="${days == 7}">7 ngày</option>
    </select>
    <input type="hidden" id="offset" th:value="${offset}">
</div>

<!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal">
    Trợ giúp
</button>
<!-- Modal -->
<div class="modal fade" id="myModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Hướng Dẫn</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <!-- Modal body -->
            <div class="modal-body">
                <p th:utext="${helpInfo}"></p>
            </div>
            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>


<!-- Bảng lịch -->
<div class="table-container">
    <table class="calendar-table">
        <!-- Header -->
        <thead>
        <tr>
            <th>Giờ</th>
            <th th:each="dayLuck, iter : ${calendar}">
                <span th:text="${dayLuck.dayOfWeek}"></span><br>
                <span th:text="${dayLuck.day + '/' + dayLuck.month}"></span><br>
                <span>Âm lịch:</span> <span th:text="${lunarDates[iter.index]}"></span>
            </th>
        </tr>
        </thead>
        <!-- Body -->
        <tbody>
        <tr th:each="timeIndex : ${customSequence}">
            <td th:text="${calendar[0].timeLuckList[timeIndex].formattedTime}"></td>
            <td th:each="dayLuck : ${calendar}" th:style="'background-color: ' + ${dayLuck.timeLuckList[timeIndex].color}">
                <div class="day-box">
                    <span th:utext="${dayLuck.timeLuckList[timeIndex].detailedInfo}"></span>
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</div>



<div th:replace="~{fragments/footer :: footer}"></div>
</body>
</html>